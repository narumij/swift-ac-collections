# REVIEW_NOTES

## 目的
- レビュー時に暗黙の不変性と、許容する失敗モードを共有する。
- ブランチ方針（API 互換の有無や配布先）を明記し、読者の前提ズレを避ける。
- AIの認識齟齬を補うためのメモを残す。

## ブランチ方針
- release/AtCoder/2025 は搭載版（触らない）。
- compatible/AtCoder/2025 は搭載版に多少現在を反映するための互換ブランチ。
- このブランチは API 互換を保証しない。

## メモリ方針
- 自分で確保したメモリしか触らない。
- 確保してないメモリを触る可能性がある場合は必ず fatal で止める。

## 不変前提（破れたらバグ）
- endIndex は不変である。
- 空ツリーでも end_ptr は存在する前提で扱う。
- _SealedTag の raw は負値にならない。

## fatalError方針
- 破れた不変前提に到達した場合は fatalError / precondition で落としてよい。
- 「確保してないメモリに触れる可能性がある」時点で、必ず fatal で止める。
- たまに手抜きで force unwrap があるが、追々 fatal error 等に直す。

## Result の扱い
- Result は回収する層と即死させる層を区別する。
- try? / try! は「落とすべき箇所の手抜き」になりやすいので注意する。

## Index / Range の注意
- 削除で Index は無効化される。
- isValid を使うべき箇所と、使わない前提の箇所を区別する。

## レビュー観点
- 暗黙の不変性を壊していないか。
- Result 経路の整合性が崩れていないか。
- Index の有効性が破られる操作がないか。
